import { ElementWithContextMenu } from '../utils.js';
/**
 * View with channel selector/**
 *
 * @category BottomBar
 */
export class ChannelView extends ElementWithContextMenu {
    /**
    * Get names of all selectable channels
    * @returns Promise resolving to array of strings - channel names
    */
    async getChannelNames() {
        // stabilize view otherwise we might run into stale element issues
        // eslint-disable-next-line wdio/no-pause
        await browser.pause(500);
        const select = await this.parent.$(this.locatorMap.BottomBarViews.outputChannels);
        await select.click();
        // stabilize view otherwise we might run into stale element issues
        // eslint-disable-next-line wdio/no-pause
        await browser.pause(500);
        const channels = await this.parent.$$(`${this.locatorMap.BottomBarViews.outputChannels} option`);
        const names = [];
        for (const channel of channels) {
            names.push(await channel.getAttribute('value'));
        }
        return names;
    }
    /**
     * Get name of the current channel
     * @returns Promise resolving to the current channel name
     */
    async getCurrentChannel() {
        const combo = await this.parent.$(this.locatorMap.BottomBarViews.channelCombo);
        return combo.getAttribute('title');
    }
    /**
     * Select a channel using the selector combo
     * @param name name of the channel to open
     */
    async selectChannel(name) {
        const select = await this.parent.$(this.locatorMap.BottomBarViews.outputChannels);
        await select.click();
        const channels = await this.parent.$$(`${this.locatorMap.BottomBarViews.outputChannels} option`);
        for (const channel of channels) {
            const val = await channel.getValue();
            if (val === name) {
                await channel.click();
                // eslint-disable-next-line wdio/no-pause
                await browser.pause(200);
                await browser.keys(['Escape']);
                return;
            }
        }
        throw new Error(`Channel ${name} not found`);
    }
}
/**
 * View with channel selection and text area
 */
export class TextView extends ChannelView {
    /**
     * Get all text from the currently open channel
     * @returns Promise resolving to the view's text
     */
    async getText() {
        const lines = await this.elem.$(this.locatorMap.OutputView.lines);
        const textLines = await browser.execute((elem) => Array.from(elem.children).map((l) => l.innerText), lines);
        return textLines
            // strip empty lines (usually the last one)
            .filter(Boolean)
            // replace `\u00A0` characters with white space
            // eslint-disable-next-line no-control-regex
            .map((l) => l.replace(/\u00A0/g, ' '));
    }
    /**
     * Clear the text in the current channel
     * @returns Promise resolving when the clear text button is pressed
     */
    async clearText() {
        await this.parent
            .$(this.locatorMap.BottomBarViews.actionsContainer(this.actionsLabel))
            .$(this.locatorMap.BottomBarViews.clearText)
            .click();
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQWJzdHJhY3RWaWV3cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9wYWdlb2JqZWN0cy9ib3R0b21CYXIvQWJzdHJhY3RWaWV3cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxhQUFhLENBQUE7QUFFcEQ7Ozs7R0FJRztBQUNILE1BQU0sT0FBZ0IsV0FBZSxTQUFRLHNCQUF5QjtJQUdsRTs7O01BR0U7SUFDRixLQUFLLENBQUMsZUFBZTtRQUNqQixrRUFBa0U7UUFDbEUseUNBQXlDO1FBQ3pDLE1BQU0sT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUN4QixNQUFNLE1BQU0sR0FBRyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsY0FBYyxDQUFDLGNBQXdCLENBQUMsQ0FBQTtRQUMzRixNQUFNLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQTtRQUVwQixrRUFBa0U7UUFDbEUseUNBQXlDO1FBQ3pDLE1BQU0sT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUN4QixNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsY0FBYyxTQUFTLENBQUMsQ0FBQTtRQUVoRyxNQUFNLEtBQUssR0FBRyxFQUFFLENBQUE7UUFDaEIsS0FBSyxNQUFNLE9BQU8sSUFBSSxRQUFRLEVBQUU7WUFDNUIsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLE9BQU8sQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQTtTQUNsRDtRQUNELE9BQU8sS0FBSyxDQUFBO0lBQ2hCLENBQUM7SUFFRDs7O09BR0c7SUFDSCxLQUFLLENBQUMsaUJBQWlCO1FBQ25CLE1BQU0sS0FBSyxHQUFHLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsWUFBc0IsQ0FBQyxDQUFBO1FBQ3hGLE9BQU8sS0FBSyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQTtJQUN0QyxDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLGFBQWEsQ0FBRSxJQUFZO1FBQzdCLE1BQU0sTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsY0FBd0IsQ0FBQyxDQUFBO1FBQzNGLE1BQU0sTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFBO1FBQ3BCLE1BQU0sUUFBUSxHQUFHLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLGNBQWMsQ0FBQyxjQUFjLFNBQVMsQ0FBQyxDQUFBO1FBQ2hHLEtBQUssTUFBTSxPQUFPLElBQUksUUFBUSxFQUFFO1lBQzVCLE1BQU0sR0FBRyxHQUFHLE1BQU0sT0FBTyxDQUFDLFFBQVEsRUFBRSxDQUFBO1lBQ3BDLElBQUksR0FBRyxLQUFLLElBQUksRUFBRTtnQkFDZCxNQUFNLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQTtnQkFDckIseUNBQXlDO2dCQUN6QyxNQUFNLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUE7Z0JBQ3hCLE1BQU0sT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUE7Z0JBQzlCLE9BQU07YUFDVDtTQUNKO1FBQ0QsTUFBTSxJQUFJLEtBQUssQ0FBQyxXQUFXLElBQUksWUFBWSxDQUFDLENBQUE7SUFDaEQsQ0FBQztDQUNKO0FBRUQ7O0dBRUc7QUFDSCxNQUFNLE9BQWdCLFFBQVksU0FBUSxXQUFjO0lBR3BEOzs7T0FHRztJQUNILEtBQUssQ0FBQyxPQUFPO1FBQ1QsTUFBTSxLQUFLLEdBQUcsTUFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxLQUFlLENBQUMsQ0FBQTtRQUMzRSxNQUFNLFNBQVMsR0FBRyxNQUFNLE9BQU8sQ0FBQyxPQUFPLENBQ25DLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUNmLElBQThCLENBQUMsUUFBNEMsQ0FDL0UsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsRUFDekIsS0FBSyxDQUNSLENBQUE7UUFFRCxPQUFPLFNBQVM7WUFDWiwyQ0FBMkM7YUFDMUMsTUFBTSxDQUFDLE9BQU8sQ0FBQztZQUNoQiwrQ0FBK0M7WUFDL0MsNENBQTRDO2FBQzNDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQTtJQUM5QyxDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLFNBQVM7UUFDWCxNQUFNLElBQUksQ0FBQyxNQUFNO2FBQ1osQ0FBQyxDQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsY0FBYyxDQUFDLGdCQUE2QixDQUFDLElBQUksQ0FBQyxZQUFZLENBQVcsQ0FBQzthQUM3RixDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsU0FBbUIsQ0FBQzthQUNyRCxLQUFLLEVBQUUsQ0FBQTtJQUNoQixDQUFDO0NBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFbGVtZW50V2l0aENvbnRleHRNZW51IH0gZnJvbSAnLi4vdXRpbHMuanMnXG5cbi8qKlxuICogVmlldyB3aXRoIGNoYW5uZWwgc2VsZWN0b3IvKipcbiAqXG4gKiBAY2F0ZWdvcnkgQm90dG9tQmFyXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDaGFubmVsVmlldzxUPiBleHRlbmRzIEVsZW1lbnRXaXRoQ29udGV4dE1lbnU8VD4ge1xuICAgIHByb3RlY3RlZCBhY3Rpb25zTGFiZWwhOiBzdHJpbmdcblxuICAgIC8qKlxuICAgICogR2V0IG5hbWVzIG9mIGFsbCBzZWxlY3RhYmxlIGNoYW5uZWxzXG4gICAgKiBAcmV0dXJucyBQcm9taXNlIHJlc29sdmluZyB0byBhcnJheSBvZiBzdHJpbmdzIC0gY2hhbm5lbCBuYW1lc1xuICAgICovXG4gICAgYXN5bmMgZ2V0Q2hhbm5lbE5hbWVzICgpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIC8vIHN0YWJpbGl6ZSB2aWV3IG90aGVyd2lzZSB3ZSBtaWdodCBydW4gaW50byBzdGFsZSBlbGVtZW50IGlzc3Vlc1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgd2Rpby9uby1wYXVzZVxuICAgICAgICBhd2FpdCBicm93c2VyLnBhdXNlKDUwMClcbiAgICAgICAgY29uc3Qgc2VsZWN0ID0gYXdhaXQgdGhpcy5wYXJlbnQuJCh0aGlzLmxvY2F0b3JNYXAuQm90dG9tQmFyVmlld3Mub3V0cHV0Q2hhbm5lbHMgYXMgc3RyaW5nKVxuICAgICAgICBhd2FpdCBzZWxlY3QuY2xpY2soKVxuXG4gICAgICAgIC8vIHN0YWJpbGl6ZSB2aWV3IG90aGVyd2lzZSB3ZSBtaWdodCBydW4gaW50byBzdGFsZSBlbGVtZW50IGlzc3Vlc1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgd2Rpby9uby1wYXVzZVxuICAgICAgICBhd2FpdCBicm93c2VyLnBhdXNlKDUwMClcbiAgICAgICAgY29uc3QgY2hhbm5lbHMgPSBhd2FpdCB0aGlzLnBhcmVudC4kJChgJHt0aGlzLmxvY2F0b3JNYXAuQm90dG9tQmFyVmlld3Mub3V0cHV0Q2hhbm5lbHN9IG9wdGlvbmApXG5cbiAgICAgICAgY29uc3QgbmFtZXMgPSBbXVxuICAgICAgICBmb3IgKGNvbnN0IGNoYW5uZWwgb2YgY2hhbm5lbHMpIHtcbiAgICAgICAgICAgIG5hbWVzLnB1c2goYXdhaXQgY2hhbm5lbC5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5hbWVzXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IG5hbWUgb2YgdGhlIGN1cnJlbnQgY2hhbm5lbFxuICAgICAqIEByZXR1cm5zIFByb21pc2UgcmVzb2x2aW5nIHRvIHRoZSBjdXJyZW50IGNoYW5uZWwgbmFtZVxuICAgICAqL1xuICAgIGFzeW5jIGdldEN1cnJlbnRDaGFubmVsICgpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCBjb21ibyA9IGF3YWl0IHRoaXMucGFyZW50LiQodGhpcy5sb2NhdG9yTWFwLkJvdHRvbUJhclZpZXdzLmNoYW5uZWxDb21ibyBhcyBzdHJpbmcpXG4gICAgICAgIHJldHVybiBjb21iby5nZXRBdHRyaWJ1dGUoJ3RpdGxlJylcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZWxlY3QgYSBjaGFubmVsIHVzaW5nIHRoZSBzZWxlY3RvciBjb21ib1xuICAgICAqIEBwYXJhbSBuYW1lIG5hbWUgb2YgdGhlIGNoYW5uZWwgdG8gb3BlblxuICAgICAqL1xuICAgIGFzeW5jIHNlbGVjdENoYW5uZWwgKG5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBzZWxlY3QgPSBhd2FpdCB0aGlzLnBhcmVudC4kKHRoaXMubG9jYXRvck1hcC5Cb3R0b21CYXJWaWV3cy5vdXRwdXRDaGFubmVscyBhcyBzdHJpbmcpXG4gICAgICAgIGF3YWl0IHNlbGVjdC5jbGljaygpXG4gICAgICAgIGNvbnN0IGNoYW5uZWxzID0gYXdhaXQgdGhpcy5wYXJlbnQuJCQoYCR7dGhpcy5sb2NhdG9yTWFwLkJvdHRvbUJhclZpZXdzLm91dHB1dENoYW5uZWxzfSBvcHRpb25gKVxuICAgICAgICBmb3IgKGNvbnN0IGNoYW5uZWwgb2YgY2hhbm5lbHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbCA9IGF3YWl0IGNoYW5uZWwuZ2V0VmFsdWUoKVxuICAgICAgICAgICAgaWYgKHZhbCA9PT0gbmFtZSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IGNoYW5uZWwuY2xpY2soKVxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSB3ZGlvL25vLXBhdXNlXG4gICAgICAgICAgICAgICAgYXdhaXQgYnJvd3Nlci5wYXVzZSgyMDApXG4gICAgICAgICAgICAgICAgYXdhaXQgYnJvd3Nlci5rZXlzKFsnRXNjYXBlJ10pXG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDaGFubmVsICR7bmFtZX0gbm90IGZvdW5kYClcbiAgICB9XG59XG5cbi8qKlxuICogVmlldyB3aXRoIGNoYW5uZWwgc2VsZWN0aW9uIGFuZCB0ZXh0IGFyZWFcbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFRleHRWaWV3PFQ+IGV4dGVuZHMgQ2hhbm5lbFZpZXc8VD4ge1xuICAgIHByb3RlY3RlZCBhY3Rpb25zTGFiZWwhOiBzdHJpbmdcblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgdGV4dCBmcm9tIHRoZSBjdXJyZW50bHkgb3BlbiBjaGFubmVsXG4gICAgICogQHJldHVybnMgUHJvbWlzZSByZXNvbHZpbmcgdG8gdGhlIHZpZXcncyB0ZXh0XG4gICAgICovXG4gICAgYXN5bmMgZ2V0VGV4dCAoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgICAgICBjb25zdCBsaW5lcyA9IGF3YWl0IHRoaXMuZWxlbS4kKHRoaXMubG9jYXRvck1hcC5PdXRwdXRWaWV3LmxpbmVzIGFzIHN0cmluZylcbiAgICAgICAgY29uc3QgdGV4dExpbmVzID0gYXdhaXQgYnJvd3Nlci5leGVjdXRlKFxuICAgICAgICAgICAgKGVsZW0pID0+IEFycmF5LmZyb20oXG4gICAgICAgICAgICAgICAgKGVsZW0gYXMgYW55IGFzIEhUTUxEaXZFbGVtZW50KS5jaGlsZHJlbiBhcyBhbnkgYXMgQXJyYXlMaWtlPEhUTUxEaXZFbGVtZW50PlxuICAgICAgICAgICAgKS5tYXAoKGwpID0+IGwuaW5uZXJUZXh0KSxcbiAgICAgICAgICAgIGxpbmVzXG4gICAgICAgIClcblxuICAgICAgICByZXR1cm4gdGV4dExpbmVzXG4gICAgICAgICAgICAvLyBzdHJpcCBlbXB0eSBsaW5lcyAodXN1YWxseSB0aGUgbGFzdCBvbmUpXG4gICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAgICAgICAvLyByZXBsYWNlIGBcXHUwMEEwYCBjaGFyYWN0ZXJzIHdpdGggd2hpdGUgc3BhY2VcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb250cm9sLXJlZ2V4XG4gICAgICAgICAgICAubWFwKChsKSA9PiBsLnJlcGxhY2UoL1xcdTAwQTAvZywgJyAnKSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciB0aGUgdGV4dCBpbiB0aGUgY3VycmVudCBjaGFubmVsXG4gICAgICogQHJldHVybnMgUHJvbWlzZSByZXNvbHZpbmcgd2hlbiB0aGUgY2xlYXIgdGV4dCBidXR0b24gaXMgcHJlc3NlZFxuICAgICAqL1xuICAgIGFzeW5jIGNsZWFyVGV4dCAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHRoaXMucGFyZW50XG4gICAgICAgICAgICAuJCgodGhpcy5sb2NhdG9yTWFwLkJvdHRvbUJhclZpZXdzLmFjdGlvbnNDb250YWluZXIgYXMgRnVuY3Rpb24pKHRoaXMuYWN0aW9uc0xhYmVsKSBhcyBzdHJpbmcpXG4gICAgICAgICAgICAuJCh0aGlzLmxvY2F0b3JNYXAuQm90dG9tQmFyVmlld3MuY2xlYXJUZXh0IGFzIHN0cmluZylcbiAgICAgICAgICAgIC5jbGljaygpXG4gICAgfVxufVxuIl19